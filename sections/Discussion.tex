\chapter{Discussion}
\label{discussion}
\clearpage

\pdfbookmark[1]{Small molecules}{sec:small-molecules}
\pdfbookmark[2]{Small molecules}{sec:small-molecules}

\subsubsection{Small molecules}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%% PROTOCOLS %%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Chemical descriptors are at the core of cheminformatics. Indeed, there are many strategies aimed at encapsulating the structure of drug-like compounds in a format amenable for computational applications. Extended connectivity fingerprints (ECFPs) represent the most popular approach to do so, due to their high interpretability, low computational cost and strong performance in various prediction tasks \cite{rogers_extended-connectivity_2010}. Other classical and popular representations include substructure-based fingerprints \cite{durant_reoptimization_2002}, Murcko scaffolds \cite{bemis_properties_1996} and, more recently, SMILES- and graph-based embeddings built upon transformer architectures \cite{shin_self-attention_2019, zhou_uni-mol_2022}. However, bioactivity descriptors offer an alternative, and arguably more clinically relevant, perspective to navigate the chemical space in the search for new bioactive compounds with desired pharmacological properties. The CC bioactivity signatures, in particular, have demonstrated superior performance over chemical descriptors in various predictive tasks and have been successfully applied to identify small molecules that reverse transcriptional signatures associated with Alzheimer’s disease \textit{in vivo} \cite{pauls_identification_2021}, as well as compounds that target cancer-related proteins previously considered undruggable \cite{bertoni_bioactivity_2021}.

We have implemented the CC protocol to process, sanitize, compress, harmonize and integrate novel bioactivity data in the CC universe of small molecule signatures. In brief, we have illustrated the incorporation of new compounds to an already existing bioactivity space (annotated mechanisms of action, B1.002), we have updated an existing space with differently processed data (transcriptomics, D1.002) and we have created two new bioactivity spaces from scratch, including human proteomics data (D6.001) and the antibiotic behavior of marketed drugs against a defined set of bacterial strains (M1.001). To our knowledge, there is no alternative strategy for processing and integrating user-provided biological data in response to chemical perturbations to generate customized bioactivity signatures. 


However, the CC data integration pipeline has some drawbacks and limitations that need to be acknowledged. First, as all frameworks designed to process external user-provided data, the integrity of the final outcome is ultimately tied to the quality of the input data: suboptimal, noisy or otherwise compromised data can significantly degrade the results and produce unreliable signatures. To help the user evaluate their signatures, diagnosis plots provide a quantification of biological and chemical signals recapitulated by the newly generated spaces, intended to provide insights on the biomedical information captured by the user data.

It is also important to consider that input datasets having a small overlap with the CC compound universe may result in type III signatures mostly based on the chemical properties of the small molecules, since the lack of additional bioactivity data might impact the SNN training. In line with this, it is likely that small molecules with no reported bioactivity in a specific CC space are eventually characterized by the so-called null signatures, corresponding to the average signature derived from the training set. To partially control this effect, every inferred CC type III signature is accompanied by an applicability score that measures the overall degree of confidence in the compound signature. Such applicability scores make it possible to filter out compounds that have unreliable signatures, potentially leading to more accurate and trustworthy results. In short, those compounds that are distant from the CC universe of molecules, those leading to unrobust predictions upon signature dropout and those having a low expected \textit{a priori} accuracy (i.e. contingent to the predictive power across different CC spaces) will yield low applicability values.

Another limitation of most CC bioactivity signatures, similar to many machine and deep learning-related approaches\cite{jimenez-luna_artificial_2021, vamathevan_applications_2019}, is the lack of direct interpretability. In fact, only type 0 signatures are directly explainable, since signature elements (columns) correspond to well-defined biological features (e.g. chemical substructures, binding targets, clinical side effects, etc.). However, type I, II and III signatures are abstract molecular representations for which experimental data (biological features) cannot be deconvoluted. In any case, it has been already shown that CC signatures are useful across various tasks, and it is indeed possible to achieve a nuanced degree of interpretability by identifying which bioactivity signatures are more valuable and relevant for the predicted outcomes\cite{bertoni_bioactivity_2021}. 

Finally, another potential limitation of the implemented pipeline is the relatively high computational cost associated with the generation of type III signatures. This step integrates all available bioactivity signatures in the CC and benefits from memory availability, extensive parallelization and GPU computing. A twin version of the type III signature fit method has been previously designed to allow the execution of this step in a predefined HPC cluster. It is worth mentioning that computational cost is usually not a problem in the other steps of the protocol.  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%% NAVIGATING %%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Although the implemented CC framework to process bioactivity data generates useful bioactivity signatures, only a negligible fraction of the overall chemical space has publicly available biological annotations derived from experimental tests. To overcome this significant limitation, our lab previously trained a series of deep neural networks able to infer bioactivity signatures for uncharacterized chemical compounds. 

Indeed, we have observed that inferred CC signatures provide an excellent basis for clustering chemical libraries and visualizing the chemical space in an insightful manner. Initially, we employed chemistry-based CC signatures in a clustering approach to select a representative set of molecules from a large compound library. With a random selection, the distribution biases inherent in the original library would have been preserved in the final representative set, leading to the overrepresentation of certain chemical features or scaffolds. Clustering approaches help mitigate this issue, ensuring a more balanced representation of the chemical space. 

Additionally, we have shown how distinct chemical libraries may cover significantly different regions of the chemical space. In particular, we observed a marked contrast, using both chemical and bioactivity signatures, between natural product libraries and collections of synthetic compounds, highlighting their complementary nature in the context of drug discovery. Dimensionality reduction techniques, such as tSNE, PCA and UMAP, are key to providing an interpretable (although abstract) 2D representation of the chemical space, facilitating the visualization and understanding of relationships and differences between compounds from various sources.

Although signaturizers can characterize any compound of interest, the level of signature confidence (i.e. applicability value) may differ significantly depending on the small molecule, as is the case with CC type III signatures. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%% STEREOISOMERS %%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Additionally, inferred CC signatures entirely depend on the initial characterization of the small molecules under study. To predict bioactivity signatures, compounds are first represented using classical (2D) ECFPs, which are then input into the neural network (one per CC space) to generate the final CC signature. While classical ECFPs are state-of-the-art for chemical representation, they lack 3D information and are therefore blind to chirality. Given that biological matter is inherently chiral, distinct stereoisomers may elicit different effects in biological systems. 

The divergent behavior of stereoisomers is indeed context-dependent and often challenging to anticipate. In some cases, bioactivity differences between two stereoisomers may simply lead to subtle affinity changes against their target(s). In others, one stereoisomer may prove therapeutically useful, while the other could be highly toxic. 

In view of this, we conducted a large-scale evaluation of the relationship between stereoisomerism and bioactivity, analyzing over 57k compounds. Our findings revealed that approximately 40\% of stereoisomer pairs exhibited, to some extent, distinct bioactivities (i.e. protein binding profiles). However, a major limitation of this analysis is the reliance on assumptions regarding inactive protein-ligand pairs, as not all of these have been experimentally validated. Although such assumptions are fairly common in cheminformatics, where the probability of a random compound binding with a given protein is essentially zero \cite{dobson_chemical_2004}, this may not be as negligible when specifically dealing with stereoisomeric compounds. 

Building on our findings, we implemented a new strategy to train a second generation of signaturizers (aka Signaturizers 3D), now capable of capturing compound stereochemistry, and built upon the embedding of computationally generated 3D conformers. Indeed, a simple extension to using chiral ECFPs instead of classical ECFPs might have sufficed to capture stereochemical properties and would allow the signatures to distinguish distinct stereoisomers. However, chiral ECFPs are still 2D and thus unable to capture the local 3D neighborhood of different space regions, which has been shown pivotal to represent relationships between atoms that are distant in terms of bond connectivity but close in 3D space\cite{axen_simple_2017}. The ability of capturing such neighboring properties is crucial for certain applications, like those in which small molecules interact with a 3D (and chiral) counterpart (e.g. protein-ligand binding). Conformer generation is indeed a more expensive task that comes together with several drawbacks such as the quality, the relevance and the variability of the generated conformers, but the treatment of molecules as 3D entities opens the room to advanced modeling and predicting capabilities in 3D-related tasks. Moreover, the use of equivariant graph neural networks (EGNNs) to model molecular conformer properties has been proven superior than 2D representations in several tasks (e.g. toxicity \cite{cremer_equivariant_2023}), fully in line with the higher prediction capabilities of transformer-related ML architectures in drug discovery (e.g. prediction of protein structures and biomolecular interactions \cite{jumper_highly_2021, abramson_accurate_2024}).

Thus, since the computational cost of generating the conformers and the overall speed of the Signaturizers3D is very affordable (i.e. 16s per 1,000 molecules, on average) with modern GPUs, we decided to go with the latest, and superior in many tasks, encoding provided by Uni-Mol \cite{zhou_uni-mol_2022}. 

\subsubsection{Protein Druggable Pockets}

Even if any molecule can be characterized using their 3D conformation and the signaturizers, not all proteins are suited to be targeted by a small molecule. Indeed, only those proteins with well-defined pockets amenable to perform relevant physicochemical interactions with smaller compounds are suitable to be targeted by small molecules. 

Borrowing the concept of descriptors to characterize chemical compounds in the field of cheminformatics, pocket descriptors offer an efficient and fast way to represent and compare pockets. 

In this thesis we introduced, benchmarked, evaluated and applied PocketVec, a novel ligand-based methodology to generate pocket descriptors that overcomes the limitations of existing methods (e.g. the explicit presence of a crystalized ligand, alignment-dependency, etc). By screening a predefined set of 128 lead-like molecules, carefully selected through several benchmarking exercises, we build a numerical descriptor ranking each of these molecules (from 1 to 128) to represent each pocket.

With our strategy, we exhaustively characterized all pockets identified in human protein domains, using both experimentally validated and computationally predicted protein structures. Additionally, pockets were identified by considering the location of pharmacologically relevant ligands (holo structures) as well as implementing pocket detection algorithms. After characterizing more than 32k pockets in 20k human protein domains with PocketVec descriptors, we assessed the effect of protein flexibility upon their generation, showcasing their ability to comprehensively characterize pocket conformational ensembles. In addition, we illustrated how PocketVec descriptors provide complementary insights to classical structure and sequence-based pocket comparisons, as well as their potential to identify protein (kinase) pairs sharing experimentally validated active compounds (inhibitors).

While the underlying PocketVec hypothesis reflects a general trend, not all individual cases may hold. In other words, the fact that a single compound is consistently upranked for two pockets may serve as initial evidence of pocket similarity but is insufficient to provide similar PocketVec descriptors if no other compounds are ranked systematically. In practical terms, this translates into pockets that share an increasing number of ligands being more likely to be similar from a PocketVec perspective, similar to the conclusion reached by Shoichet and co-workers when they presented the similarity ensemble approach (SEA) to reveal protein remote relationships \cite{keiser_relating_2007}. Throughout our studies, we indeed observed that as the number of shared compounds increases, the PocketVec distance decreases. 

In addition, it is important to note that a high correlation between docking scores and real binding affinities (i.e. docking accuracy) is not essential to our approach. Instead, the key assumption is that similar binding pockets will yield similar rankings in the virtual screening of compounds. As demonstrated in the conducted studies, this generally holds true for the docking software used, rDock.

By definition, the analyses performed with PocketVec descriptors are limited to the folded proteome, excluding intrinsically disordered regions and unfolded domains that lack defined pockets, whose characterization is beyond the scope of this study. 


However, the comprehensive characterization of pockets found in human folded domains presented in this work is subject to several important limitations. First, the use of a single representative structure for each domain does not reflect the dynamic nature of proteins. As such, a single PocketVec descriptor, derived from a specific structure, should be viewed as a snapshot-based characterization of the pocket for that particular structure rather than a global representation of the pocket. Additionally, the identification of pockets in apo structures is entirely dependent on prediction algorithms, and their characterization does not necessarily indicate pharmacological relevance. Finally, the quality of PocketVec descriptors is intrinsically tied to the quality of the underlying structures, which is particularly relevant when working with AF2 structures.

The ability of AF2 to accurately predict protein structures is well-established \cite{jumper_highly_2021, tunyasuvunakool_highly_2021}. However, its capacity to identify novel folds that are significantly different from those in the PDB, which served as part of its training dataset, remains a topic of ongoing discussion \cite{akdel_structural_2022}. Similar to X-ray derived structures, AF2 models provide static representations of proteins and do not fully account for the dynamic conformational landscape that proteins can adopt under different physiological conditions. In addition, AF2 is usually not sensitive to point mutations and is unable to model post-translational modifications, both of which may significantly alter protein structure and function. Finally, ligands (e.g. organic small molecules) are also excluded from AF2-predicted protein structures.

Overall, to obtain a broader biological context, X-ray structures and AF2 models need to be complemented with other techniques such as cryo-EM and NMR, capable of providing insights into protein dynamics and conformational variability. We have evaluated how PocketVec descriptors behave in MD studies and multiple X-ray structures from the same pocket, demonstrating its robustness and consistency upon protein flexibility and variability. Additionally, while AlphaFold 3 (AF3) is not freely available to the global scientific community, it offers the potential to model protein structures in more complex environments, including interactions with small molecules, RNA and other biochemical entities\cite{abramson_accurate_2024}. The need of open-source tools in science is crucial as they foster collaboration, accelerate innovation, and ensure that cutting-edge methodologies are accessible to the entire research community. \hl{In this thesis, all code is … in public repositories. }

Despite the mentioned limitations, AF2 and protein structure prediction methods are invaluable tools to provide an initial glimpse of protein folds, though often requiring refinement before detailed analyses\cite{zhang_benchmarking_2023, holcomb_evaluation_2023, scardino_how_2023}. Indeed, these methods offer insights into both naturally evolved proteins and those artificially designed, broadening the scope of structural biology and protein engineering. Identifying and characterizing pockets within these proteins may reveal novel drug targets and enhance small molecule design, opening new possibilities for therapeutic development.

\hl{Pockets -types of pockets? Check Paper PLOS ONE }